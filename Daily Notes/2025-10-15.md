---
date: 2025-10-15
type: daily-log
aliases:
  - Oct15
tags:
  - daily-log
---

## First thing:
---

## üîç HubSpot Bug Bounty Discovery - GraphQL Investigation

### What We Found Today

Today I discovered two important JavaScript files that HubSpot uses to power their website. Think of these files like instruction manuals that tell the website how to talk to HubSpot's servers and get information.

**File 1: loader.js** - This is like a phone book that lists all the different services HubSpot uses
**File 2: apollo.bundle.js** - This is like a detailed instruction manual for how HubSpot asks questions and gets answers from their database

### Breaking It Down Simply

#### What Is GraphQL?

Imagine you're at a restaurant. In the old way (REST API), you'd have to order:
- Appetizer from counter #1
- Main dish from counter #2
- Dessert from counter #3

With GraphQL, you tell ONE waiter: "I want appetizer X, main dish Y, and dessert Z" - and they bring it all at once.

HubSpot uses GraphQL to make their website faster. But this also means if we find bugs in their GraphQL system, we might be able to:
- See data we shouldn't see
- Ask for information about other companies using HubSpot
- Find weak spots in their security

#### What the loader.js File Told Us

This file showed us **40+ different services** HubSpot uses:

**Money Stuff**:
- `growth-payments-core` - How they handle credit cards and payments
- `payment-link-components` - Payment pages

**Customer Data**:
- `customer-data-objects` - Where they store customer information
- `crm-pipelines` - Sales tracking systems

**AI Features**:
- `ai-addon-copilot-preview` - Their AI assistant (like ChatGPT for HubSpot)

**Spying Tools** (not bad spying - just tracking):
- `metrics-js` - Tracks what users click on
- `usage-tracker` - Monitors how people use features
- `raven-hubspot` - Reports errors (uses a service called Sentry)

**Third-Party Services**:
- `ably` - Real-time chat/messaging
- `wootric-nps` - Customer feedback surveys

#### What the Apollo Bundle Told Us

This file revealed **HOW** HubSpot talks to their servers using GraphQL.

**Key Discovery**: HubSpot built their own **custom version** of Apollo (the GraphQL tool). It's like they took a Toyota Camry and modified it with custom parts - version 3.43 with special HubSpot features.

**What Made It Custom**:
1. **apollo-stack-hubspot@3.43** - Their modified version
2. **apollo-dlb@3.41** - Their "Data Loading Bridge" (special connector)
3. **Internal build path exposed**: `/usr/share/hubspot/build/` - This tells us where their servers are organized

**Why This Matters**: Custom modifications sometimes have bugs that the original Toyota (Apollo) doesn't have.

### What We Learned

#### 1. **HubSpot's Architecture Is Like a Restaurant Chain**

```
Customer (You)
    ‚Üì
Waiter (apollo-dlb - HubSpot's custom layer)
    ‚Üì
Kitchen Manager (apollo-stack-hubspot)
    ‚Üì
Kitchen (GraphQL server at /graphql)
    ‚Üì
Storage Room (Database)
```

Each layer can have security problems:
- **Bad waiter**: Takes wrong orders to wrong tables (IDOR bug - seeing other people's data)
- **Confused manager**: Doesn't check if you're allowed to order from VIP menu (authorization bypass)
- **Sneaky customer**: Asks for 1000 meals at once to overwhelm kitchen (DOS attack)

#### 2. **Found 157 Source Files in the Bundle**

It's like finding the restaurant's entire recipe book! Each file does something specific:
- `ApolloClient.js` - Main ordering system
- `directives.js` - Special menu modifications allowed
- `caches.js` - The memory of previous orders
- `pagination.js` - How to handle big menus

#### 3. **Discovered Internal Tools**

- **Package manager**: `bpm` (HubSpot's internal tool)
- **Build tool**: `bender-build-tools` version 1.1482
- **Build location**: `/usr/share/hubspot/build/`

This is like finding out the restaurant uses a special ordering system from a supplier named "bpm".

### What We Can Do Next

#### Step 1: Test the GraphQL Endpoint (Easy)

Try visiting HubSpot's GraphQL "kitchen door":
```
https://app.hubspot.com/graphql
```

Ask it: "What's on the menu?" (This is called introspection)
```graphql
{
  __schema {
    types {
      name
    }
  }
}
```

If it answers, we can see EVERYTHING they offer - like getting the entire menu including secret dishes.

#### Step 2: Look for Weak Spots (Medium)

**Test 1: Can I see other people's orders?**
- Try changing customer IDs in requests
- Example: If your ID is 12345, try 12346

**Test 2: Can I order without paying?**
- Test payment endpoints for price manipulation
- Try ordering "enterprise plan" but setting price to $0

**Test 3: Can I overwhelm the kitchen?**
- Send 100 orders at once (batch testing)
- See if they have limits

#### Step 3: Use Chrome DevTools (What You're Doing Now)

Open Chrome DevTools and look for:
- Network tab ‚Üí Filter by "graphql"
- Watch what questions HubSpot asks
- Copy those questions and modify them

**In the Console, type**:
```javascript
// See Apollo's brain
window.__APOLLO_CLIENT__

// See what data it remembers
window.__APOLLO_CLIENT__.cache.extract()
```

This shows you HubSpot's "short-term memory" - what data they're caching in your browser.

### Real-World Example

Let's say HubSpot's GraphQL has this query:
```graphql
query GetAccount($accountId: ID!) {
  account(id: $accountId) {
    name
    email
    billingInfo {
      creditCard
      amount
    }
  }
}
```

**The Bug**: Maybe they check if you own account #12345, but NOT if you're allowed to see `billingInfo`.

**The Test**:
1. Run query with YOUR account ID ‚úÖ Works
2. Try SOMEONE ELSE's account ID ‚ùå Should fail
3. If it works ‚Üí You found an IDOR bug! üí∞

### Why This Is Valuable

Bug bounty programs pay for findings like:
- **Critical**: You can see all customer credit cards ($5,000-$25,000)
- **High**: You can see one other company's data ($1,500-$5,000)
- **Medium**: You can spam their system ($500-$1,500)
- **Low**: You find information they didn't hide well ($100-$500)

### My Next Steps

1. ‚úÖ **DONE**: Found and analyzed Apollo bundle
2. ‚úÖ **DONE**: Created service map with 40+ services
3. ‚úÖ **DONE**: Identified GraphQL architecture
4. ‚è≠Ô∏è **NEXT**: Open Chrome DevTools and capture real GraphQL queries
5. ‚è≠Ô∏è **NEXT**: Test `/graphql` endpoint for introspection
6. ‚è≠Ô∏è **NEXT**: Dump `window.__APOLLO_CLIENT__` to see cached data
7. ‚è≠Ô∏è **NEXT**: Try changing IDs in GraphQL queries (IDOR testing)
8. ‚è≠Ô∏è **NEXT**: Test payment endpoints for price manipulation

### What I Learned About Security Research

**It's like being a detective**:
1. **Gather clues** (JavaScript files, network requests)
2. **Map the building** (create service maps)
3. **Find the doors** (discover API endpoints)
4. **Test the locks** (try to access things you shouldn't)
5. **Report to police** (submit bug bounty report)

The JavaScript files are like finding the building's blueprints - they show you exactly how everything is connected.

### Files Created Today

- `HubSpot-Service-Map.md` - Directory of all 40+ services
- `Apollo-Bundle-Analysis.md` - Deep dive on GraphQL system
- `loader.js Service Analysis copy.md` - Original service discovery

These are now my "research notes" I can reference as I test each service.

---
## explain this
"It abstracts away raw network handling, URLs, and HTTP verbs, letting developers call typed async functions instead of manually writing fetch/axios requests."
